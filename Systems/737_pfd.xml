<?xml version="1.0"?>

<PropertyList>

    <filter>
        <name>IAS lower speed limit</name>
        <type>gain</type>
        <gain>1.0</gain>
        <update-interval-secs type="double">0.1</update-interval-secs>
        <input> 
            <expression>
                <table>
                    <property>/fdm/jsbsim/inertia/weight-lbs</property> 
                    <entry><ind>617294</ind><dep>138</dep></entry>
                    <entry><ind>655875</ind><dep>141</dep></entry>
                    <entry><ind>873030</ind><dep>158</dep></entry>
                </table>
            </expression>
        </input>
        <output>instrumentation/weu/state/stall-speed</output>
    </filter>

    <filter>
        <name>Mmo converted to IAS speed limit</name>
        <type>gain</type>
        <gain>1.0</gain>
        <update-interval-secs type="double">0.1</update-interval-secs>
        <input>
          <condition>
            <not-equals>
              <property>/instrumentation/airspeed-indicator/true-speed-kt</property>
              <value>0</value>
            </not-equals>
          </condition>
            <expression>
              <div>
                <product>
                  <property>/fdm/jsbsim/atmosphere/a-fps</property>
                  <value>0.82</value>
                  <value>0.5913174946</value>
                  <property>/instrumentation/airspeed-indicator/indicated-speed-kt</property>
                </product>
                <property>/instrumentation/airspeed-indicator/true-speed-kt</property>
               </div>
            </expression>
        </input>
        <input>
          <value>500</value>
        </input>
        <output>instrumentation/pfd/mmo-kt</output>
    </filter>
    
    <filter>
        <name>VSI needle</name>
        <type>gain</type>
        <gain>1.0</gain>
        <update-interval-secs type="double">0.04</update-interval-secs>
        <input> 
            <expression>
                <table>
                    <property>velocities/vertical-speed-fps</property>
                    <entry><ind>-100</ind><dep>-68.8</dep></entry>
                    <entry><ind>-66.6666</ind><dep>-66.5</dep></entry>
                    <entry><ind>-33.3333</ind><dep>-63.5</dep></entry>
                    <entry><ind>-25</ind><dep>-57.5</dep></entry>
                    <entry><ind>-16.6666</ind><dep>-50</dep></entry>
                    <entry><ind>-8.3333</ind><dep>-30.5</dep></entry>
                    <entry><ind>8.3333</ind><dep>30.5</dep></entry>
                    <entry><ind>16.6666</ind><dep>50</dep></entry>
                    <entry><ind>25</ind><dep>57.5</dep></entry>
                    <entry><ind>33.3333</ind><dep>63.5</dep></entry>
                    <entry><ind>66.6666</ind><dep>66.5</dep></entry>
                    <entry><ind>100</ind><dep>68.8</dep></entry>
                </table>
            </expression>
        </input>
        <output>instrumentation/pfd/vsi-needle-deg</output>
    </filter>

  <!-- =============================================================== -->
  <!--                        PFD display preprocessors                -->
  <!-- =============================================================== -->

  <!-- =============================================================== -->
  <!--                 speed trend vector processing                   -->
  <!-- =============================================================== -->

  <filter>
    <name>Median airspeed last 1 sec</name>
    <type>moving-average</type>
    <samples>120</samples>
    <input>instrumentation/airspeed-indicator/indicated-speed-kt</input>
    <output>instrumentation/pfd/airspeed-kt-1sec-avg</output>
  </filter>

  <predict-simple>
    <name>speed predictor (smoothed)</name>
    <update-interval-secs type="double">0.04</update-interval-secs>
    <input>instrumentation/pfd/airspeed-kt-1sec-avg</input>
    <output>instrumentation/pfd/speed-lookahead</output>
    <seconds>10.0</seconds>
    <filter-gain>0.05</filter-gain>
  </predict-simple>

  <filter>
    <name>PFD preprocessor (spd trend up)</name>
    <type>gain</type>
    <update-interval-secs type="double">0.04</update-interval-secs>
    <input>
      <property>instrumentation/pfd/speed-lookahead</property>
    </input>
    <reference>
      <property>instrumentation/airspeed-indicator/indicated-speed-kt</property>
      <offset>90</offset>
    </reference>
    <gain>-0.002667</gain>
    <output>instrumentation/pfd/speed-trend-up</output>
    <max>0.24</max>
    <min>0</min>
  </filter>

  <filter>
    <name>PFD preprocessor (spd trend down)</name>
    <type>gain</type>
    <update-interval-secs type="double">0.04</update-interval-secs>
    <input>
      <property>instrumentation/pfd/speed-lookahead</property>
      <min>0</min>
    </input>
    <reference>
      <property>instrumentation/airspeed-indicator/indicated-speed-kt</property>
      <offset>-90</offset>
    </reference>
    <gain>-0.002667</gain>
    <output>instrumentation/pfd/speed-trend-down</output>
    <min>-0.24</min>
    <max>0</max>
  </filter>
 
    <filter>
        <name>VS autopilot</name>
        <type>gain</type>
        <gain>1</gain>
        <update-interval-secs type="double">0.1</update-interval-secs>
        <input> 
            <expression>
                <table>
                    <property>/autopilot/settings/vertical-speed-fpm</property> 
                    <entry><ind>-6000</ind><dep>-218.5</dep></entry>
                    <entry><ind>-2000</ind><dep>-169</dep></entry>
                    <entry><ind>-1000</ind><dep>-98</dep></entry>
                    <entry><ind>    0</ind><dep>0</dep></entry>
                    <entry><ind> 1000</ind><dep>98</dep></entry>
                    <entry><ind> 2000</ind><dep>169</dep></entry>
                    <entry><ind> 6000</ind><dep>218.5</dep></entry>
                </table>
            </expression>
        </input>
        <output>instrumentation/pfd/target-vs</output>
    </filter>

</PropertyList>
